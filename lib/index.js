"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const createNode_1 = require("./createNode");
const fileAdd = process.env.FILEADD;
const port = Number(process.env.PORT);
const filename = `./peerId${fileAdd}.json`;
const topic = "gossip";
(async () => {
    const node = await createNode_1.createNode(filename, port);
    await node.pubsub.subscribe(topic, (msg) => {
        console.log(`Received: ${msg.data.toString()}`);
    });
    setInterval(() => {
        const randomNumber = Math.floor(Math.random() * 9999);
        node.pubsub.publish(topic, Buffer.from(`Hey its me ${node.peerId.toB58String()} - ${randomNumber}`));
    }, 100 + Math.random() * 100);
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBMEM7QUFFMUMsTUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUM7QUFDcEMsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDdEMsTUFBTSxRQUFRLEdBQUcsV0FBVyxPQUFPLE9BQU8sQ0FBQztBQUUzQyxNQUFNLEtBQUssR0FBRyxRQUFRLENBQUM7QUFFdkIsQ0FBQyxLQUFLLElBQUksRUFBRTtJQUNWLE1BQU0sSUFBSSxHQUFHLE1BQU0sdUJBQVUsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFFOUMsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFRLEVBQUUsRUFBRTtRQUM5QyxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDbEQsQ0FBQyxDQUFDLENBQUM7SUFFSCxXQUFXLENBQUMsR0FBRyxFQUFFO1FBQ2YsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUM7UUFDdEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQ2pCLEtBQUssRUFDTCxNQUFNLENBQUMsSUFBSSxDQUFDLGNBQWMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsTUFBTSxZQUFZLEVBQUUsQ0FBQyxDQUN6RSxDQUFDO0lBQ0osQ0FBQyxFQUFFLEdBQUcsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsR0FBRyxDQUFDLENBQUM7QUFDaEMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZU5vZGUgfSBmcm9tIFwiLi9jcmVhdGVOb2RlXCI7XG5cbmNvbnN0IGZpbGVBZGQgPSBwcm9jZXNzLmVudi5GSUxFQUREO1xuY29uc3QgcG9ydCA9IE51bWJlcihwcm9jZXNzLmVudi5QT1JUKTtcbmNvbnN0IGZpbGVuYW1lID0gYC4vcGVlcklkJHtmaWxlQWRkfS5qc29uYDtcblxuY29uc3QgdG9waWMgPSBcImdvc3NpcFwiO1xuXG4oYXN5bmMgKCkgPT4ge1xuICBjb25zdCBub2RlID0gYXdhaXQgY3JlYXRlTm9kZShmaWxlbmFtZSwgcG9ydCk7XG5cbiAgYXdhaXQgbm9kZS5wdWJzdWIuc3Vic2NyaWJlKHRvcGljLCAobXNnOiBhbnkpID0+IHtcbiAgICBjb25zb2xlLmxvZyhgUmVjZWl2ZWQ6ICR7bXNnLmRhdGEudG9TdHJpbmcoKX1gKTtcbiAgfSk7XG5cbiAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgIGNvbnN0IHJhbmRvbU51bWJlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDk5OTkpO1xuICAgIG5vZGUucHVic3ViLnB1Ymxpc2goXG4gICAgICB0b3BpYyxcbiAgICAgIEJ1ZmZlci5mcm9tKGBIZXkgaXRzIG1lICR7bm9kZS5wZWVySWQudG9CNThTdHJpbmcoKX0gLSAke3JhbmRvbU51bWJlcn1gKVxuICAgICk7XG4gIH0sIDEwMCArIE1hdGgucmFuZG9tKCkgKiAxMDApO1xufSkoKTtcbiJdfQ==